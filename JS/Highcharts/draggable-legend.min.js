!function(y){var b=y.addEvent,d=y.defined,e=(y.each,y.wrap);e(y.Legend.prototype,"render",function(e){e.apply(this,Array.prototype.slice.call(arguments,1));var t=this,i=t.options,n=i.padding||5,r=t.contentGroup.getBBox(!0);t.box.isNew=!0,r.width+2*n>t.options.width&&(t.options.width=Math.ceil(r.width)+2*n,e.apply(this,Array.prototype.slice.call(arguments,1))),!t.resizer&&i.resizable&&(t.addResizer(),t.bindResizerEvents()),t.resizer&&(t.alignResizer(),t.contentGroup.attr({translateY:parseFloat(t.itemStyle.fontSize)+4})),t.alignContentGroup(r,n)}),y.Legend.prototype.addResizer=function(){this.resizer=this.chart.renderer.path(["M",0,10,"L",10,10,"L",10,0,"L",11,0,"L",11,11,"L",0,11,"Z"]).attr({"stroke-width":10,stroke:"transparent",fill:"black"}).css({cursor:"se-resize","pointer-events":"stroke"}).add(this.group)},y.Legend.prototype.bindResizerEvents=function(){var a,l,h,s,g=this,p=(g.options,g.chart);function e(e){var t=g.group.getBBox(!0);e=p.pointer.normalize(e),s=e.chartY,h=e.chartX,l=g.options.width||t.width,a=g.options.height||t.height,p.isResizingLegend=!0}function t(e){if(p.isResizingLegend){var t=(e=p.pointer.normalize(e)).chartY-s,i=e.chartX-h,n=g.options,r=n.padding||5,o=g.contentGroup.getBBox(!0);e.preventDefault(),n.width=Math.min(Math.max(o.width+r,l+i),p.containerWidth-20-(n.floating?n.x:5)),n.height=n.maxHeight=Math.min(Math.max(60,a+t),p.containerHeight-20-(n.floating?n.y:5)),g.group.placed=!1,d(g.currentPage)&&(g.currentPage=1,g.scroll(1-g.currentPage,!1)),g.render(),g.alignContentGroup(o,r),p.pointer.selectionMarker&&(p.pointer.selectionMarker=p.pointer.selectionMarker.destroy())}}function i(){p.isResizingLegend&&g.update(),p.isResizingLegend=!1}p.isResizingLegend=!1,p.removeResizableEvents&&y.each(p.removeResizableEvents,function(e){e()}),p.removeResizableEvents=[b(g.resizer.element,"mousedown",e),b(p.container,"mousemove",t),b(document,"mouseup",i),b(g.resizer.element,"touchstart",e),b(p.container,"touchmove",t),b(document,"touchend",i)]},y.Legend.prototype.alignContentGroup=function(e,t){var i=this.title?this.title.getBBox(!0).height:0,n=this.nav?this.clipHeight+t:e.height-i;this.contentGroup.placed=!1,this.contentGroup.align({align:"center",verticalAlign:this.nav?"top":"middle",x:-Math.round(e.width/2)-2*t,y:this.nav?i:-Math.round(n/2)-(this.title?0:t)},!0,this.box.getBBox(!0))},y.wrap(y.Legend.prototype,"scroll",function(e,t,i){return this.chart.afterLegendUpdate&&0===t?e.apply(this,[t,!1]):e.apply(this,Array.prototype.slice.call(arguments,1))}),y.wrap(y.Legend.prototype,"handleOverflow",function(e){var t=e.apply(this,Array.prototype.slice.call(arguments,1));return d(this.options.height)?this.options.height:t}),y.Legend.prototype.alignResizer=function(){var e=this,t=e.resizer.getBBox();e.options.floating?(e.resizer.show(),e.resizer.placed=!1,e.resizer.align({align:"right",verticalAlign:"bottom"},!0,{width:e.legendWidth-t.width-5,height:e.legendHeight-t.height-5,x:0,y:0})):e.resizer.hide()},e(y.Legend.prototype,"destroy",function(e){return this.resizer&&(this.chart.legend.options.x,this.resizer=this.resizer.destroy(),null!=GlobalchartObj.legend&&(0==this.chart.legend.options.x&&0==this.chart.legend.options.y?(GlobalchartObj.legend.x=0,GlobalchartObj.legend.y=0,GlobalchartObj.legend.width=void 0,GlobalchartObj.legend.verticalAlign="bottom",GlobalchartObj.legend.floating=!1):(GlobalchartObj.legend.x=this.chart.legend.options.x,GlobalchartObj.legend.y=this.chart.legend.options.y,GlobalchartObj.legend.verticalAlign="top",GlobalchartObj.legend.floating=!0,GlobalchartObj.legend.width=this.chart.legend.options.width))),e.apply(this,Array.prototype.slice.call(arguments,1))}),e(y.Legend.prototype,"render",function(e){var t=!this.group;e.apply(this,Array.prototype.slice.call(arguments,1));var n,r,o,a,l,h,s,g,p=this,d=p.chart,c=p.options;function i(e){g=0,e=d.pointer.normalize(e),r=e.chartX,o=e.chartY,a=c.x,l=c.y,h=p.group.attr("translateX"),s=p.group.attr("translateY"),n=!0,p.options.floating||(a=h=p.group.attr("translateX"),l=s=p.group.attr("translateY"))}function u(e){if(n&&!d.isResizingLegend){var t=(e=d.pointer.normalize(e)).chartX-r,i=e.chartY-o;e.preventDefault(),0<h+t&&h+t+p.legendWidth<d.chartWidth&&0<s+i&&s+i+p.legendHeight<d.chartHeight&&2<(g=Math.max(Math.abs(t),Math.abs(i)))&&(c.x=a+t,c.y=l+i,c.floating=!0,c.verticalAlign="top",p.group.placed=!1,p.group.align(y.extend({width:p.legendWidth,height:p.legendHeight},c),!0,"spacingBox"),p.positionCheckboxes()),d.pointer.selectionMarker&&(d.pointer.selectionMarker=d.pointer.selectionMarker.destroy())}}function v(){n&&g&&!d.isResizingLegend&&(d.afterLegendUpdate=!0,c.y+p.legendHeight>.9*d.chartHeight?p.update({x:0,y:0,floating:!1,verticalAlign:"bottom",layout:"horizontal"}):p.update({floating:!0})),n=!1}c.draggable&&p.group&&t&&(d.removeDraggableEvents&&y.each(d.removeDraggableEvents,function(e){e()}),p.group.css({cursor:"move"}),d.removeDraggableEvents=[b(p.group.element,"mousedown",i),b(d.container,"mousemove",u),b(document,"mouseup",v),b(p.group.element,"touchstart",i),b(d.container,"touchmove",u),b(document,"touchend",v),b(d,"redraw",function(){c.x+p.legendWidth>d.containerWidth&&(c.x=d.containerWidth-p.legendWidth-10,p.group.placed=!1,p.group.align(y.extend({width:p.legendWidth,height:p.legendHeight},c),!0,"spacingBox"),p.positionCheckboxes())})])})}(Highcharts);
